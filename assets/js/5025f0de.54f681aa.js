"use strict";(self.webpackChunkresgrid_docs=self.webpackChunkresgrid_docs||[]).push([[1957],{3905:(e,t,o)=>{o.d(t,{Zo:()=>u,kt:()=>m});var n=o(7294);function r(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}function a(e,t){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)}return o}function i(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?a(Object(o),!0).forEach((function(t){r(e,t,o[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(o,t))}))}return e}function s(e,t){if(null==e)return{};var o,n,r=function(e,t){if(null==e)return{};var o,n,r={},a=Object.keys(e);for(n=0;n<a.length;n++)o=a[n],t.indexOf(o)>=0||(r[o]=e[o]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)o=a[n],t.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(r[o]=e[o])}return r}var l=n.createContext({}),p=function(e){var t=n.useContext(l),o=t;return e&&(o="function"==typeof e?e(t):i(i({},t),e)),o},u=function(e){var t=p(e.components);return n.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var o=e.components,r=e.mdxType,a=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),c=p(o),m=r,h=c["".concat(l,".").concat(m)]||c[m]||d[m]||a;return o?n.createElement(h,i(i({ref:t},u),{},{components:o})):n.createElement(h,i({ref:t},u))}));function m(e,t){var o=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=o.length,i=new Array(a);i[0]=c;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var p=2;p<a;p++)i[p]=o[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,o)}c.displayName="MDXCreateElement"},5348:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>s,toc:()=>p});var n=o(7462),r=(o(7294),o(3905));const a={sidebar_position:3},i="Offline Laptop",s={unversionedId:"self-hosted/laptop",id:"self-hosted/laptop",title:"Offline Laptop",description:"In this guide we will get Resgrid up in running via Docker Compose for local (single user) use on a Windows computer.",source:"@site/docs/self-hosted/laptop.md",sourceDirName:"self-hosted",slug:"/self-hosted/laptop",permalink:"/self-hosted/laptop",draft:!1,editUrl:"https://github.com/Resgrid/docs/tree/develop/docs/self-hosted/laptop.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"Installation",permalink:"/self-hosted/installation"},next:{title:"Offline Multi-User",permalink:"/self-hosted/rick"}},l={},p=[{value:"Use Case",id:"use-case",level:2},{value:"System Requirements",id:"system-requirements",level:2},{value:"Setup Notice",id:"setup-notice",level:2},{value:"Prerequisites &amp; Dependencies",id:"prerequisites--dependencies",level:2},{value:"Docker Compose Setup",id:"docker-compose-setup",level:2},{value:"Run the Docker Compose",id:"run-the-docker-compose",level:2},{value:"Initial Web Login",id:"initial-web-login",level:2},{value:"Updating",id:"updating",level:2},{value:"What&#39;s Next?",id:"whats-next",level:2}],u={toc:p};function d(e){let{components:t,...o}=e;return(0,r.kt)("wrapper",(0,n.Z)({},u,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"offline-laptop"},"Offline Laptop"),(0,r.kt)("p",null,"In this guide we will get Resgrid up in running via Docker Compose for local (single user) use on a Windows computer."),(0,r.kt)("admonition",{title:"Warranty",type:"danger"},(0,r.kt)("p",{parentName:"admonition"},"Resgrid's self hosted version is provided with no warranty, no guarantee of suitability and limited free support (Github Issues and Discussions only).\nUpdates for our self hosted version are infrequent compared to our hosted version due to the additional cost in time to create those releases. We try\nour best to ensure an easy and working system that doesn't require a lot of tweaking, but due to it's complexity that is difficult.")),(0,r.kt)("h2",{id:"use-case"},"Use Case"),(0,r.kt)("p",null,"This setup is intended to get Resgrid up and running on a single-user environment, like a laptop that will not be connected to or have internet access. No external users (i.e. from another machine or mobile device) will be connecting to this installation. For example you are coordinate rescue and recovery efforts for a hurricane from a location on your laptop, you are communicate with your field teams only via a radio as there is no power or cell phone data/WiFi Internet. "),(0,r.kt)("h2",{id:"system-requirements"},"System Requirements"),(0,r.kt)("p",null,"1.) Windows 10 or Windows 11 Laptop with WSL2 (Windows Subsystem for Linux)\n2.) Docker Desktop with WSL2 Enabled\n3.) Enough HDD Space to handle Mapping Data (if you want a large region like North America you'll need 30+ GB)\n4.) 4 or more Core Processor\n5.) 16GB or more of RAM"),(0,r.kt)("h2",{id:"setup-notice"},"Setup Notice"),(0,r.kt)("p",null,"There is no redundancy, backup or fail-over in this setup. Everything runs on the local computer and is not intended to be accessed by anyone off of the local computer. If the local computer gets damaged this could result in loss of data. It's recommend that you have a USB drive that you can backup the database to (ideally the whole resgrid directory) periodically during the operation."),(0,r.kt)("h2",{id:"prerequisites--dependencies"},"Prerequisites & Dependencies"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Update Windows"),(0,r.kt)("li",{parentName:"ol"},"Install WSL2 and Ubuntu 22.04 ",(0,r.kt)("a",{parentName:"li",href:"https://documentation.ubuntu.com/wsl/en/latest/guides/install-ubuntu-wsl2/"},"https://documentation.ubuntu.com/wsl/en/latest/guides/install-ubuntu-wsl2/")),(0,r.kt)("li",{parentName:"ol"},"Open up your Ubuntu 22.04 instance and finalize the setup (set password)."),(0,r.kt)("li",{parentName:"ol"},"Install Docker ",(0,r.kt)("a",{parentName:"li",href:"https://docs.docker.com/desktop/wsl/"},"https://docs.docker.com/desktop/wsl/")," and enable WSL2 backend.")),(0,r.kt)("h2",{id:"docker-compose-setup"},"Docker Compose Setup"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Open Notepad as Administrator and open C:\\Windows\\System32\\drivers\\etc\\hosts file.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Add the following lines to the hosts file and save."))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"127.0.0.1      rg.mylocal\n127.0.0.1      rgapi.mylocal\n127.0.0.1      rgevents.mylocal\n127.0.0.1      rgtile.mylocal\n")),(0,r.kt)("p",null,"If you get a permissions error you didn't open up Notepad as Administrator, also don't use any RichText editor (Wordpad, Word, etc)."),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"Navigate to Geofabrik ",(0,r.kt)("a",{parentName:"li",href:"https://download.geofabrik.de/"},"https://download.geofabrik.de/")," and download the .osm.pbf file the region you will be operating in. ")),(0,r.kt)("p",null,"It is not recommend to try and pull an entire Sub Region (i.e. North America) as that will take quite a long time to import into the database. Instead it's recommended to import and additional Sub (Sub) Region, like a US State (i.e. Florida) or a Special Sub Region if they are available (i.e. US South). "),(0,r.kt)("ol",{start:4},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Using the Windows File Explorer move the osm.pbf file into Linux (left side bar) Ubuntu-22.04, home and your username folder. This will put it in your home directory.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Start your Ubuntu-22.04 WSL2 Instance so the command prompt is visible.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Clone the setup scripts for the Laptop compose:"))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"git clone https://github.com/Resgrid/resgrid-setup.git -b laptop resgrid\n")),(0,r.kt)("p",null,"You should now have a folder called resgrid in your current directory."),(0,r.kt)("ol",{start:7},(0,r.kt)("li",{parentName:"ol"},"Open the resgrid directory:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"cd resgrid\n")),(0,r.kt)("ol",{start:8},(0,r.kt)("li",{parentName:"ol"},"Import the osm.pbf you downloaded and placed in your home directory into the tile server. Change /home/yourname/yourregion.osm.pbf in the command below to the correct home directory name (yourname) and the name of the region file you downloaded (yourregion).")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker run \\\n    -v /home/yourname/yourregion.osm.pbf:/data/region.osm.pbf \\\n    -v ./docker-data/osm:/data/database/ \\\n    overv/openstreetmap-tile-server \\\n    import\n")),(0,r.kt)("p",null,"If the container exits without errors, then your data has been successfully imported and you are now ready to run the tile server. If you selected a very large region, like North America this process can take days."),(0,r.kt)("h2",{id:"run-the-docker-compose"},"Run the Docker Compose"),(0,r.kt)("p",null,"Once you have setup the environment variables you can now run the docker compose file in the resgrid directory:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker compose up\n")),(0,r.kt)("p",null,"That will run the interactive version of the containers, Ctrl+C will stop the containers."),(0,r.kt)("p",null,"If you want to run the containers in the background, use the -d option:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker compose up -d\n")),(0,r.kt)("p",null,"The Resgrid system will take about 5 minutes to start up fully, this is due to the startup order of the containers. The last container to startup will be the web container, once that one is ready, you can now access the system."),(0,r.kt)("h2",{id:"initial-web-login"},"Initial Web Login"),(0,r.kt)("p",null,"Open up your web browser and navigate to ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("a",{parentName:"strong",href:"https://rg.mylocal"},"https://rg.mylocal")),", ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("a",{parentName:"strong",href:"https://rgapi.mylocal"},"https://rgapi.mylocal")),", ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("a",{parentName:"strong",href:"https://rgevents.mylocal"},"https://rgevents.mylocal"))," and ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("a",{parentName:"strong",href:"https://rgtile.mylocal"},"https://rgtile.mylocal")),". You will need to accept the self-signed cert for each url and add exceptions in the browsers. You can follow this guide ",(0,r.kt)("a",{parentName:"p",href:"https://it.nmu.edu/docs/adding-security-exception-your-browser"},"https://it.nmu.edu/docs/adding-security-exception-your-browser")," to add those exceptions."),(0,r.kt)("p",null,"Once you have completed the steps above you will be able to log into the web applications user interface. Open up a web browser and navigate to ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("a",{parentName:"strong",href:"https://rg.mylocal"},"https://rg.mylocal")),", you will then be prompted by the login screen. Your default administrator credentials are ",(0,r.kt)("strong",{parentName:"p"},"admin/changeme1234"),". Once you log into the system it\u2019s recommended that you change your admin password from the Edit Profile page by clicking on the Administrator name in the upper left hand corner."),(0,r.kt)("h2",{id:"updating"},"Updating"),(0,r.kt)("p",null,"To update Resgrid you'll need to stop the system, clear the current containers and restart."),(0,r.kt)("p",null,"Stop all running containers."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker compose down\n")),(0,r.kt)("p",null,"Remove all cached images (to ensure we get new ones)."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker rmi -f $(docker images -aq)\n")),(0,r.kt)("p",null,"Restart the containers and they will pull new containers."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"docker compose up -d\n")),(0,r.kt)("h2",{id:"whats-next"},"What's Next?"),(0,r.kt)("p",null,"This Quick Start gets the system running via local host, but not externally or within your network. You will need to create DNS entries in your internal or external DNS server to point to the server that is running the containers. It's also recommend you change some default values in the resgrid.env file to ensure proper security."))}d.isMDXComponent=!0}}]);